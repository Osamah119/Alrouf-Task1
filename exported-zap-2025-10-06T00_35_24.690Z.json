{"metadata":{"version":2},"zaps":[{"id":1,"title":"task1","nodes":{"1":{"id":1,"paused":false,"type_of":"read","params":{"label_ids":"Label_4908301068313667022"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"label_ids":"RFQ"}},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":null,"root_id":null,"action":"message","selected_api":"GoogleMailV2CLIAPI@2.6.1","title":"task1","authentication_id":"2fc5be9d3b567dd7739f5ca77b796ceca8d288697bdbecdb86f1599c6ce7f3d4"},"2":{"id":2,"paused":true,"type_of":"write","params":{"transform":"string.re_extract","findall":"no","multiline":"no","dotall":"no","ignorecase":"no","inputs":"{{1__body_plain}}","pattern":"(?i)(?:regards?|best\\s+regards?|sincerely)[,\\s]*([A-Za-z\\u0600-\\u06FF]+\\.?\\s+[A-Za-z\\u0600-\\u06FF\\s]+)"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"transform":"Extract Pattern","findall":"No","multiline":"No","dotall":"No","ignorecase":"No"},"stepTitle":"F.CutomerName"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":1,"root_id":1,"action":"text_line_item","selected_api":"ZapierFormatterCLIAPI@1.0.7","title":null,"authentication_id":null},"3":{"id":3,"paused":true,"type_of":"write","params":{"transform":"date.manipulate","inputs":"{{1__raw__payload__headers__Date}}{{1__date}}","expression":"{{1__date}}","to_format":"ddd MMM DD HH:mm:ss Z YYYY"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"transform":"Add/Subtract Time"}},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":2,"root_id":1,"action":"datetime_line_item","selected_api":"ZapierFormatterCLIAPI@1.0.7","title":null,"authentication_id":null},"4":{"id":4,"paused":true,"type_of":"write","params":{"transform":"string.email_extract_v2","inputs":"{{1__body_plain}}"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"transform":"Extract Email Address"},"stepTitle":"F.Extract Email"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":3,"root_id":1,"action":"text_line_item","selected_api":"ZapierFormatterCLIAPI@1.0.7","title":null,"authentication_id":null},"5":{"id":5,"paused":true,"type_of":"write","params":{"transform":"string.re_extract","inputs":"{{1__body_plain}}","findall":"no","multiline":"no","dotall":"no","ignorecase":"no","pattern":"(?i)(\\+?966[-\\s]?5[\\dX-]{7,8}|0[-\\s]?5[\\dX-]{7,8})"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"transform":"Extract Pattern","findall":"No","multiline":"No","dotall":"No","ignorecase":"No"},"stepTitle":"F.phone"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":4,"root_id":1,"action":"text_line_item","selected_api":"ZapierFormatterCLIAPI@1.0.7","title":null,"authentication_id":null},"6":{"id":6,"paused":true,"type_of":"write","params":{"transform":"string.number_extract","inputs":"{{1__body_plain}}"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"transform":"Extract Number"},"stepTitle":"F.Qty"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":5,"root_id":1,"action":"text_line_item","selected_api":"ZapierFormatterCLIAPI@1.0.7","title":null,"authentication_id":null},"7":{"id":7,"paused":true,"type_of":"write","params":{"transform":"string.re_extract","findall":true,"multiline":false,"dotall":false,"ignorecase":false,"inputs":"{{1__body_plain}}","pattern":"(?i)\\b(ALR-[A-Z0-9-]+)\\b"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"transform":"Extract Pattern"},"stepTitle":"F.SKU"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":6,"root_id":1,"action":"text_line_item","selected_api":"ZapierFormatterCLIAPI@1.0.7","title":null,"authentication_id":null},"8":{"id":8,"paused":true,"type_of":"write","params":{"transform":"string.re_extract","findall":"no","multiline":"no","dotall":"no","ignorecase":"no","inputs":"{{1__body_plain}}","pattern":"(?i)\\b(?:in|في)\\s+([A-Za-z\\u0600-\\u06FF]+)"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"transform":"Extract Pattern","findall":"No","multiline":"No","dotall":"No","ignorecase":"No"},"stepTitle":"F.City"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":7,"root_id":1,"action":"text_line_item","selected_api":"ZapierFormatterCLIAPI@1.0.7","title":null,"authentication_id":null},"9":{"id":9,"paused":true,"type_of":"write","params":{"transform":"string.re_extract","findall":"no","multiline":"no","dotall":"no","ignorecase":"no","inputs":"{{1__body_plain}}","pattern":"(?i)\\b(\\d+)\\s*weeks?\\b"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"transform":"Extract Pattern","findall":"No","multiline":"No","dotall":"No","ignorecase":"No"},"stepTitle":"F.Weeks"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":8,"root_id":1,"action":"text_line_item","selected_api":"ZapierFormatterCLIAPI@1.0.7","title":null,"authentication_id":null},"10":{"id":10,"paused":true,"type_of":"write","params":{"transform":"number.random_number","lower_range":"10000000000","upper_range":"99999999999","decimal_points":"0"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"transform":"Random Number"},"stepTitle":"F.MockID"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":9,"root_id":1,"action":"number_line_item","selected_api":"ZapierFormatterCLIAPI@1.0.7","title":null,"authentication_id":null},"11":{"id":11,"paused":true,"type_of":"write","params":{"body_type":"html","thread_id":"199b1cf9abb63b1f","to":["{{4__output}}"],"cc":["{{4__output}}"],"from":"osamahhate33@gmail.com","subject":"Re: {{1__subject}} — RFQ received (Ref )\r\n","reply_to":"{{4__output}}","body":"<p dir=\"rtl\">مرحبًا {{2__output__0}},</p>\r\n<p dir=\"rtl\">\r\n  استلمنا طلب عرض السعر الخاص بك (<strong>{{7__output[]0}}</strong>، كمية: <strong>{{6__output}}</strong>) لمدينة {{8__output__0}}.<br/>\r\n  رقم المرجع لدينا: <strong>{{10__output}}</strong>. سنعود إليك خلال <strong>1–2 يوم عمل</strong>.\r\n</p>\r\n<hr/>\r\n<p>Hello {{2__output__0}},</p>\r\n<p>\r\n  We received your RFQ (<strong>{{7__output[]0}}</strong>, Qty: <strong>{{6__output}}</strong>) for {{8__output__0}}.<br/>\r\n  Our reference: <strong>{{10__output}}</strong>. We’ll reply within <strong>1–2 business days</strong>.\r\n</p>\r\n<p>Best regards,<br/>Alrouf Sales</p>\r\n"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"thread_id":"199b1cf9abb63b1f","from":"osamahhate33@gmail.com"},"stepTitle":"Reply to Email"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":10,"root_id":1,"action":"reply_to_message","selected_api":"GoogleMailV2CLIAPI@2.6.1","title":null,"authentication_id":"2fc5be9d3b567dd7739f5ca77b796ceca8d288697bdbecdb86f1599c6ce7f3d4"},"12":{"id":12,"paused":true,"type_of":"write","params":{"timezone":true,"drive":"","spreadsheet":"1CiSDhwspSIDqq32ZIEStDpIXcUpgcZTUsHwlwBKVjE4","worksheet":"0","COL$A":"{{1__date}}","COL$B":"{{2__output__0}}","COL$C":"{{4__output}}","COL$D":"{{5__output___matched}}","COL$E":"{{1__subject}}","COL$F":"{{7__output[]0}}","COL$G":"{{6__output}}","COL$H":"{{8__output__0}}","COL$I":"{{9__output__0}}","COL$N":"{{1__body_plain}}","COL$K":"{{1__all_attachments}}","COL$L":"{{10__output}}","COL$J":"received","COL$M":"received"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"drive":"My Google Drive","spreadsheet":"RFQ Inbox","worksheet":"الورقة1"}},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":11,"root_id":1,"action":"add_row","selected_api":"GoogleSheetsV2CLIAPI@2.9.0","title":null,"authentication_id":"046b1388510547ba140084aec90ae84578ad326f692c9e1ed9b08427eec7f404"},"13":{"id":13,"paused":true,"type_of":"write","params":{"drive":"","folder":"1BY1zb6CsqUJyOKNtGodaD5C0ik36oqjU","title":"{{1__date}}{{2__output__0}}{{4__output}}{{7__output[]0}}{{6__output}}{{8__output__0}}"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"drive":"My Google Drive","folder":"task1"}},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":12,"root_id":1,"action":"folder","selected_api":"GoogleDriveCLIAPI@1.15.3","title":null,"authentication_id":"ee5275b09cf69f0f454b052a6f76231f319960871320808a69d6b72ce46294e1"},"14":{"id":14,"paused":true,"type_of":"write","params":{"input":{"id":"{{10__output}}","client_email":"{{4__output}}","sku_or_model":"{{7__output[]0}}","qty":"{{6__output}}","city":"{{8__output__0}}","needed_in_weeks":"{{9__output__0}}","received_at":"{{1__date}}","row":"{{12__row}}"},"code":"// تأكيد الأنواع وقيم افتراضية آمنة\nconst toInt = v => {\n  const n = parseInt(String(v).replace(/[^0-9.-]/g,''), 10);\n  return Number.isFinite(n) ? n : 0;\n};\n\nconst payload = {\n  id: inputData.id || \"UNKNOWN_ID\",\n  client_email: inputData.client_email || \"unknown@client.com\",\n  sku: inputData.sku_or_model || \"UNKNOWN_SKU\",\n  qty: toInt(inputData.qty),\n  city: inputData.city || \"UNKNOWN_CITY\",\n  weeks: toInt(inputData.needed_in_weeks),\n  created_at: inputData.received_at || inputData.zap_meta_timestamp || new Date().toISOString(),\n  sheet_row: inputData.row || -1\n};\n\nreturn { json_text: JSON.stringify(payload, null, 2) };"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"input":"RFQ Data Fields","code":"CRM JSON Builder Code"},"stepTitle":"Build CRM JSON"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":13,"root_id":1,"action":"01929fad-d3dd-62c2-52ed-7868d5fcc691","selected_api":"CodeCLIAPI@1.0.1","title":null,"authentication_id":null},"15":{"id":15,"paused":true,"type_of":"write","params":{"drive":"","folder":"{{13__id}}","title":"crm_opportunity_{{10__output}}.json","file":"{{14__json_text}}","convert":"false"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"convert":"False","drive":"My Google Drive"},"stepTitle":"Drive.Create CRM JSON"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":14,"root_id":1,"action":"newtxtfile","selected_api":"GoogleDriveCLIAPI@1.15.3","title":null,"authentication_id":"ee5275b09cf69f0f454b052a6f76231f319960871320808a69d6b72ce46294e1"},"16":{"id":16,"paused":true,"type_of":"write","params":{"unflatten":"yes","return_raw_response":"no","method":"POST","url":"https://hooks.slack.com/services/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","data":"{\n  \"blocks\": [\n    {\n      \"type\": \"header\",\n      \"text\": {\n        \"type\": \"plain_text\",\n        \"text\": \"🆕 New RFQ Received\"\n      }\n    },\n    {\n      \"type\": \"section\",\n      \"fields\": [\n        {\n          \"type\": \"mrkdwn\",\n          \"text\": \"*Client:* {{2__output__0}}\"\n        },\n        {\n          \"type\": \"mrkdwn\",\n          \"text\": \"*Email:* {{4__output}}\"\n        },\n        {\n          \"type\": \"mrkdwn\",\n          \"text\": \"*Phone:* {{5__output___matched}}\"\n        },\n        {\n          \"type\": \"mrkdwn\",\n          \"text\": \"*City:* {{8__output__0}}\"\n        },\n        {\n          \"type\": \"mrkdwn\",\n          \"text\": \"*SKU:* {{7__output[]0}}\"\n        },\n        {\n          \"type\": \"mrkdwn\",\n          \"text\": \"*Quantity:* {{6__output}}\"\n        },\n        {\n          \"type\": \"mrkdwn\",\n          \"text\": \"*Delivery:* {{9__output__0}} weeks\"\n        },\n        {\n          \"type\": \"mrkdwn\",\n          \"text\": \"*Ref ID:* {{10__output}}\"\n        }\n      ]\n    },\n    {\n      \"type\": \"actions\",\n      \"elements\": [\n        {\n          \"type\": \"button\",\n          \"text\": {\n            \"type\": \"plain_text\",\n            \"text\": \"📊 View Spreadsheet\"\n          },\n          \"url\": \"https://docs.google.com/spreadsheets/d/1CiSDhwspSIDqq32ZIEStDpIXcUpgcZTUsHwlwBKVjE4\"\n        },\n        {\n          \"type\": \"button\",\n          \"text\": {\n            \"type\": \"plain_text\",\n            \"text\": \"📁 Open Drive Folder\"\n          },\n          \"url\": \"{{13__alternateLink}}\"\n        }\n      ]\n    }\n  ]\n}"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"method":"POST","unflatten":"Yes","return_raw_response":"No"},"stepTitle":"Custom Request"},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":15,"root_id":1,"action":"custom","selected_api":"WebHookCLIAPI@1.0.37","title":null,"authentication_id":null},"17":{"id":17,"paused":true,"type_of":"write","params":{"trim_whitespace":"true","iteration_start":"1","iteration_limit":"10","loop_values":{"attachment":"{{1__all_attachments}}"}},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"trim_whitespace":"True"}},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":16,"root_id":1,"action":"loop_values_line_items","selected_api":"ZapierLoopingCLIAPI@1.2.6","title":null,"authentication_id":null},"18":{"id":18,"paused":true,"type_of":"write","params":{"drive":"","folder":"1MSllfaV05dv_AsK1dxCZyHms-QTb8OML","file":"{{1__body_plain}}","convert":false,"new_name":"{{1__attachmentsArray}}{{2__output__0}}{{4__output}}{{7__output[]0}}"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"drive":"My Google Drive","folder":"Sun, 5 Oct 2025 01:29:47 +0300Eng. Omaromar@client.comALR-SL-90W120Dammam"}},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":17,"root_id":1,"action":"file","selected_api":"GoogleDriveCLIAPI@1.15.3","title":null,"authentication_id":"ee5275b09cf69f0f454b052a6f76231f319960871320808a69d6b72ce46294e1"},"19":{"id":19,"paused":true,"type_of":"write","params":{"drive":"","spreadsheet":"1CiSDhwspSIDqq32ZIEStDpIXcUpgcZTUsHwlwBKVjE4","worksheet":"0","row":"2","COL$K":"{{18__alternateLink}}"},"meta":{"$editor":{"has_automatic_issues":false},"parammap":{"drive":"My Google Drive","spreadsheet":"RFQ Inbox","worksheet":"الورقة1","row":"2"}},"triple_stores":{"copied_from":null,"created_by":null,"polling_interval_override":0,"block_and_release_limit_override":0,"spread_tasks":1},"parent_id":18,"root_id":1,"action":"update_row","selected_api":"GoogleSheetsV2CLIAPI@2.9.0","title":null,"authentication_id":"046b1388510547ba140084aec90ae84578ad326f692c9e1ed9b08427eec7f404"}}}]}